{"ast":null,"code":"import axios from 'axios';\nimport store from '../store';\nimport router from '../router';\nimport { Message } from 'element-ui';\n\n// 创建 axios 实例\nconst api = axios.create({\n  baseURL: process.env.VUE_APP_BASE_API || '/api',\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  timeout: 5000\n});\n\n// 请求拦截器\napi.interceptors.request.use(config => {\n  const token = store.state.token;\n  if (token) {\n    config.headers['Authorization'] = `Bearer ${token}`;\n  }\n  // 添加调试日志\n  console.log('Request config:', config);\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// 响应拦截器\napi.interceptors.response.use(response => response.data, error => {\n  console.error('API Error:', error);\n  if (error.code === 'ECONNABORTED') {\n    console.error('请求超时');\n    Message.error('请求超时，请重试');\n  } else if (error.response) {\n    switch (error.response.status) {\n      case 401:\n        store.dispatch('logout');\n        router.push('/login');\n        Message.error('登录已过期，请重新登录');\n        break;\n      case 403:\n        Message.error('没有权限执行此操作');\n        break;\n      default:\n        Message.error(error.response.data?.message || '服务器错误');\n    }\n  } else if (error.request) {\n    console.error('请求未收到响应');\n    Message.error('网络连接失败，请检查网络');\n  } else {\n    Message.error('请求发送失败');\n  }\n  return Promise.reject(error);\n});\nexport default {\n  // 用户相关\n  login: data => {\n    console.log('发送登录请求:', data);\n    const startTime = Date.now();\n    return api.post('/users/login', data).then(response => {\n      console.log('登录请求耗时:', Date.now() - startTime, 'ms');\n      console.log('登录响应:', response);\n      return response;\n    });\n  },\n  register: data => {\n    // 转换 realName 为 name\n    const convertedData = {\n      ...data,\n      name: data.realName\n    };\n    delete convertedData.realName;\n    console.log('API register 方法接收到的数据:', convertedData);\n    return api.post('/users/register', convertedData);\n  },\n  updatePassword: data => api.put('/users/password', data),\n  getUsers: () => api.get('/users'),\n  updateUser: (userId, data) => {\n    console.log('更新用户数据:', {\n      userId,\n      data\n    });\n    return api.put(`/users/${userId}`, data);\n  },\n  resetPassword: userId => api.post(`/users/${userId}/reset-password`),\n  updateUserStatus: (userId, status) => api.put(`/users/${userId}/status`, {\n    status\n  }),\n  deleteUser: userId => api.delete(`/users/${userId}`),\n  // 消息相关\n  getMessages: () => api.get('/messages/my'),\n  getSentMessages: () => api.get('/messages/sent'),\n  sendMessage: data => api.post('/messages', data),\n  sendDepartmentMessage: (deptId, data) => api.post(`/messages/department/${deptId}`, data),\n  markMessageAsRead: messageId => {\n    if (!messageId) {\n      return Promise.reject(new Error('消息ID不能为空'));\n    }\n    return api.put(`/messages/${messageId}/read`);\n  },\n  // 任务相关\n  getTasks: () => {\n    console.log('开始获取任务列表');\n    return api.get('/tasks').then(response => {\n      console.log('获取任务列表响应:', response);\n      return response;\n    });\n  },\n  getMyTasks: () => {\n    console.log('获取我的任务列表');\n    return api.get('/tasks/my');\n  },\n  getDepartmentTasks: deptId => api.get(`/tasks/department/${deptId}`),\n  createTask: data => {\n    console.log('创建任务请求数据:', data);\n    return api.post('/tasks', data).then(response => {\n      console.log('创建任务响应:', response);\n      return response;\n    });\n  },\n  updateTaskStatus: (taskId, status) => api.put(`/tasks/${taskId}/status`, status, {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  }),\n  // 部门相关\n  getDepartments: () => api.get('/departments'),\n  createDepartment: data => api.post('/departments', data),\n  updateDepartment: (deptId, data) => api.put(`/departments/${deptId}`, data),\n  deleteDepartment: deptId => api.delete(`/departments/${deptId}`),\n  assignManager: (deptId, managerId) => api.put(`/departments/${deptId}/manager/${managerId}`),\n  // 公告相关\n  getAnnouncements: (all = false) => api.get(`/announcements${all ? '?all=true' : ''}`),\n  createAnnouncement: data => api.post('/announcements', data),\n  updateAnnouncementStatus: (id, status) => api.put(`/announcements/${id}/status`, status)\n};","map":{"version":3,"names":["axios","store","router","Message","api","create","baseURL","process","env","VUE_APP_BASE_API","headers","timeout","interceptors","request","use","config","token","state","console","log","error","Promise","reject","response","data","code","status","dispatch","push","message","login","startTime","Date","now","post","then","register","convertedData","name","realName","updatePassword","put","getUsers","get","updateUser","userId","resetPassword","updateUserStatus","deleteUser","delete","getMessages","getSentMessages","sendMessage","sendDepartmentMessage","deptId","markMessageAsRead","messageId","Error","getTasks","getMyTasks","getDepartmentTasks","createTask","updateTaskStatus","taskId","getDepartments","createDepartment","updateDepartment","deleteDepartment","assignManager","managerId","getAnnouncements","all","createAnnouncement","updateAnnouncementStatus","id"],"sources":["D:/oasystem/src/main/resources/static/frontend/src/api/index.js"],"sourcesContent":["import axios from 'axios'\nimport store from '../store'\nimport router from '../router'\nimport { Message } from 'element-ui'\n\n// 创建 axios 实例\nconst api = axios.create({\n  baseURL: process.env.VUE_APP_BASE_API || '/api',\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  timeout: 5000\n})\n\n// 请求拦截器\napi.interceptors.request.use(\n  config => {\n    const token = store.state.token\n    if (token) {\n      config.headers['Authorization'] = `Bearer ${token}`\n    }\n    // 添加调试日志\n    console.log('Request config:', config)\n    return config\n  },\n  error => {\n    return Promise.reject(error)\n  }\n)\n\n// 响应拦截器\napi.interceptors.response.use(\n  response => response.data,\n  error => {\n    console.error('API Error:', error)\n    if (error.code === 'ECONNABORTED') {\n      console.error('请求超时')\n      Message.error('请求超时，请重试')\n    } else if (error.response) {\n      switch (error.response.status) {\n        case 401:\n          store.dispatch('logout')\n          router.push('/login')\n          Message.error('登录已过期，请重新登录')\n          break\n        case 403:\n          Message.error('没有权限执行此操作')\n          break\n        default:\n          Message.error(error.response.data?.message || '服务器错误')\n      }\n    } else if (error.request) {\n      console.error('请求未收到响应')\n      Message.error('网络连接失败，请检查网络')\n    } else {\n      Message.error('请求发送失败')\n    }\n    return Promise.reject(error)\n  }\n)\n\nexport default {\n  // 用户相关\n  login: data => {\n    console.log('发送登录请求:', data)\n    const startTime = Date.now()\n    return api.post('/users/login', data).then(response => {\n      console.log('登录请求耗时:', Date.now() - startTime, 'ms')\n      console.log('登录响应:', response)\n      return response\n    })\n  },\n  register: data => {\n    // 转换 realName 为 name\n    const convertedData = {\n      ...data,\n      name: data.realName\n    };\n    delete convertedData.realName;\n    \n    console.log('API register 方法接收到的数据:', convertedData)\n    return api.post('/users/register', convertedData)\n  },\n  updatePassword: data => api.put('/users/password', data),\n  getUsers: () => api.get('/users'),\n  updateUser: (userId, data) => {\n    console.log('更新用户数据:', { userId, data })\n    return api.put(`/users/${userId}`, data)\n  },\n  resetPassword: userId => api.post(`/users/${userId}/reset-password`),\n  updateUserStatus: (userId, status) => api.put(`/users/${userId}/status`, { status }),\n  deleteUser: userId => api.delete(`/users/${userId}`),\n  \n  // 消息相关\n  getMessages: () => api.get('/messages/my'),\n  getSentMessages: () => api.get('/messages/sent'),\n  sendMessage: data => api.post('/messages', data),\n  sendDepartmentMessage: (deptId, data) => api.post(`/messages/department/${deptId}`, data),\n  markMessageAsRead: messageId => {\n    if (!messageId) {\n      return Promise.reject(new Error('消息ID不能为空'))\n    }\n    return api.put(`/messages/${messageId}/read`)\n  },\n  \n  // 任务相关\n  getTasks: () => {\n    console.log('开始获取任务列表')\n    return api.get('/tasks').then(response => {\n      console.log('获取任务列表响应:', response)\n      return response\n    })\n  },\n  getMyTasks: () => {\n    console.log('获取我的任务列表')\n    return api.get('/tasks/my')\n  },\n  getDepartmentTasks: deptId => api.get(`/tasks/department/${deptId}`),\n  createTask: data => {\n    console.log('创建任务请求数据:', data)\n    return api.post('/tasks', data).then(response => {\n      console.log('创建任务响应:', response)\n      return response\n    })\n  },\n  updateTaskStatus: (taskId, status) => \n    api.put(`/tasks/${taskId}/status`, status, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }),\n  \n  // 部门相关\n  getDepartments: () => api.get('/departments'),\n  createDepartment: data => api.post('/departments', data),\n  updateDepartment: (deptId, data) => api.put(`/departments/${deptId}`, data),\n  deleteDepartment: deptId => api.delete(`/departments/${deptId}`),\n  assignManager: (deptId, managerId) => api.put(`/departments/${deptId}/manager/${managerId}`),\n  \n  // 公告相关\n  getAnnouncements: (all = false) => api.get(`/announcements${all ? '?all=true' : ''}`),\n  createAnnouncement: (data) => api.post('/announcements', data),\n  updateAnnouncementStatus: (id, status) => api.put(`/announcements/${id}/status`, status)\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}