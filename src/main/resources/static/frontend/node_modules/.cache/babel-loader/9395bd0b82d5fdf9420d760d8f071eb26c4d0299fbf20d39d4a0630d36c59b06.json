{"ast":null,"code":"import Vue from 'vue';\nimport VueRouter from 'vue-router';\nimport store from '../store';\nimport Users from '../views/Users.vue';\nimport Departments from '../views/Departments.vue';\nimport Announcements from '../views/Announcements.vue';\nimport Layout from '../layout/index.vue';\nVue.use(VueRouter);\n\n// 修复路由重复导航错误\nconst originalPush = VueRouter.prototype.push;\nVueRouter.prototype.push = function push(location) {\n  return originalPush.call(this, location).catch(err => err);\n};\nconst originalReplace = VueRouter.prototype.replace;\nVueRouter.prototype.replace = function replace(location) {\n  return originalReplace.call(this, location).catch(err => err);\n};\nconst routes = [{\n  path: '/login',\n  name: 'Login',\n  component: () => import('../views/Login.vue'),\n  meta: {\n    requiresAuth: false\n  }\n}, {\n  path: '/',\n  component: Layout,\n  redirect: '/dashboard',\n  children: [{\n    path: 'dashboard',\n    name: 'Dashboard',\n    component: () => import('../views/Dashboard.vue'),\n    meta: {\n      requiresAuth: true\n    }\n  }, {\n    path: 'messages',\n    name: 'Messages',\n    component: () => import('../views/Messages.vue'),\n    meta: {\n      requiresAuth: true\n    }\n  }, {\n    path: 'tasks',\n    name: 'Tasks',\n    component: () => import('../views/Tasks.vue'),\n    meta: {\n      requiresAuth: true\n    }\n  }, {\n    path: 'departments',\n    name: 'Departments',\n    component: Departments,\n    meta: {\n      requiresAuth: true,\n      requiresAdmin: true\n    }\n  }, {\n    path: 'users',\n    name: 'Users',\n    component: Users,\n    meta: {\n      requiresAuth: true,\n      requiresAdmin: true\n    }\n  }, {\n    path: 'announcements',\n    name: 'Announcements',\n    component: () => import('@/views/Announcements.vue'),\n    meta: {\n      requiresAuth: true,\n      roles: ['ROLE_ADMIN'] // 只允许管理员访问\n    }\n  }, {\n    path: 'leave',\n    name: 'LeaveList',\n    component: () => import('../views/leave/LeaveList.vue'),\n    meta: {\n      title: '请假管理',\n      icon: 'el-icon-date',\n      requiresAuth: true\n    }\n  }]\n}];\nconst router = new VueRouter({\n  mode: 'history',\n  base: process.env.BASE_URL,\n  routes\n});\n\n// 路由守卫\nrouter.beforeEach(async (to, from, next) => {\n  console.log('路由守卫：', {\n    to: to.fullPath,\n    from: from.fullPath,\n    isLoggedIn: store.getters.isLoggedIn,\n    user: store.getters.currentUser\n  });\n\n  // 检查路由是否需要认证\n  if (to.matched.some(record => record.meta.requiresAuth)) {\n    console.log('当前路由需要认证');\n    // 检查用户是否已登录\n    if (!store.getters.isLoggedIn) {\n      console.log('用户未登录，重定向到登录页');\n      next({\n        path: '/login',\n        query: {\n          redirect: to.fullPath\n        }\n      });\n      return;\n    }\n    // 检查是否需要管理员权限\n    if (to.matched.some(record => record.meta.requiresAdmin)) {\n      console.log('当前路由需要管理员权限');\n      if (!store.getters.isAdmin) {\n        console.log('用户不是管理员，重定向到首页');\n        next('/dashboard');\n        return;\n      }\n    }\n\n    // 检查角色权限\n    if (to.meta.roles) {\n      const userRole = store.getters.currentUser.roleId;\n      if (userRole !== 1) {\n        // 不是管理员\n        console.log('用户没有权限访问该路由');\n        next({\n          path: '/403'\n        });\n        return;\n      }\n    }\n  }\n\n  // 如果已登录用户访问登录页，重定向到首页\n  if (to.path === '/login' && store.getters.isLoggedIn) {\n    console.log('已登录用户访问登录页，重定向到首页');\n    next('/dashboard');\n    return;\n  }\n  console.log('允许导航到：', to.fullPath);\n  next();\n});\nexport default router;","map":{"version":3,"names":["Vue","VueRouter","store","Users","Departments","Announcements","Layout","use","originalPush","prototype","push","location","call","catch","err","originalReplace","replace","routes","path","name","component","meta","requiresAuth","redirect","children","requiresAdmin","roles","title","icon","router","mode","base","process","env","BASE_URL","beforeEach","to","from","next","console","log","fullPath","isLoggedIn","getters","user","currentUser","matched","some","record","query","isAdmin","userRole","roleId"],"sources":["D:/oasystem/src/main/resources/static/frontend/src/router/index.js"],"sourcesContent":["import Vue from 'vue'\nimport VueRouter from 'vue-router'\nimport store from '../store'\nimport Users from '../views/Users.vue'\nimport Departments from '../views/Departments.vue'\nimport Announcements from '../views/Announcements.vue'\nimport Layout from '../layout/index.vue'\n\nVue.use(VueRouter)\n\n// 修复路由重复导航错误\nconst originalPush = VueRouter.prototype.push\nVueRouter.prototype.push = function push(location) {\n  return originalPush.call(this, location).catch(err => err)\n}\n\nconst originalReplace = VueRouter.prototype.replace\nVueRouter.prototype.replace = function replace(location) {\n  return originalReplace.call(this, location).catch(err => err)\n}\n\nconst routes = [\n  {\n    path: '/login',\n    name: 'Login',\n    component: () => import('../views/Login.vue'),\n    meta: { requiresAuth: false }\n  },\n  {\n    path: '/',\n    component: Layout,\n    redirect: '/dashboard',\n    children: [\n      {\n        path: 'dashboard',\n        name: 'Dashboard',\n        component: () => import('../views/Dashboard.vue'),\n        meta: { requiresAuth: true }\n      },\n      {\n        path: 'messages',\n        name: 'Messages',\n        component: () => import('../views/Messages.vue'),\n        meta: { requiresAuth: true }\n      },\n      {\n        path: 'tasks',\n        name: 'Tasks',\n        component: () => import('../views/Tasks.vue'),\n        meta: { requiresAuth: true }\n      },\n      {\n        path: 'departments',\n        name: 'Departments',\n        component: Departments,\n        meta: { requiresAuth: true, requiresAdmin: true }\n      },\n      {\n        path: 'users',\n        name: 'Users',\n        component: Users,\n        meta: { requiresAuth: true, requiresAdmin: true }\n      },\n      {\n        path: 'announcements',\n        name: 'Announcements',\n        component: () => import('@/views/Announcements.vue'),\n        meta: { \n          requiresAuth: true,\n          roles: ['ROLE_ADMIN'] // 只允许管理员访问\n        }\n      },\n      {\n        path: 'leave',\n        name: 'LeaveList',\n        component: () => import('../views/leave/LeaveList.vue'),\n        meta: { title: '请假管理', icon: 'el-icon-date', requiresAuth: true }\n      }\n    ]\n  }\n]\n\nconst router = new VueRouter({\n  mode: 'history',\n  base: process.env.BASE_URL,\n  routes\n})\n\n// 路由守卫\nrouter.beforeEach(async (to, from, next) => {\n  console.log('路由守卫：', {\n    to: to.fullPath,\n    from: from.fullPath,\n    isLoggedIn: store.getters.isLoggedIn,\n    user: store.getters.currentUser\n  })\n  \n  // 检查路由是否需要认证\n  if (to.matched.some(record => record.meta.requiresAuth)) {\n    console.log('当前路由需要认证')\n    // 检查用户是否已登录\n    if (!store.getters.isLoggedIn) {\n      console.log('用户未登录，重定向到登录页')\n      next({\n        path: '/login',\n        query: { redirect: to.fullPath }\n      })\n      return\n    }\n    // 检查是否需要管理员权限\n    if (to.matched.some(record => record.meta.requiresAdmin)) {\n      console.log('当前路由需要管理员权限')\n      if (!store.getters.isAdmin) {\n        console.log('用户不是管理员，重定向到首页')\n        next('/dashboard')\n        return\n      }\n    }\n    \n    // 检查角色权限\n    if (to.meta.roles) {\n      const userRole = store.getters.currentUser.roleId\n      if (userRole !== 1) { // 不是管理员\n        console.log('用户没有权限访问该路由')\n        next({ path: '/403' })\n        return\n      }\n    }\n  }\n  \n  // 如果已登录用户访问登录页，重定向到首页\n  if (to.path === '/login' && store.getters.isLoggedIn) {\n    console.log('已登录用户访问登录页，重定向到首页')\n    next('/dashboard')\n    return\n  }\n  \n  console.log('允许导航到：', to.fullPath)\n  next()\n})\n\nexport default router "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}